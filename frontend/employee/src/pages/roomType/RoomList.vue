<template>
  <div class="card">
    <div class="card-header d-flex flex-wrap align-items-center justify-content-between gap-3">
      <!-- ÊêúÂ∞ãÂíåÁØ©ÈÅ∏ÂçÄÂüü -->
      <div class="d-flex flex-wrap align-items-center gap-3">
        <!-- ...ÂéüÊúâÊêúÂ∞ãÊ¨Ñ‰Ωç... -->

        <div class="d-flex align-items-center gap-2">
          <span>Show</span>
          <select class="form-select form-select-sm w-auto" v-model="selectedShow">
            <option value="5">5</option>
            <option value="10">10</option>
            <option value="15">15</option>
          </select>
        </div>

        <div class="icon-field">
          <input type="text" class="form-control form-control-sm w-auto" v-model="searchText" placeholder="ÊêúÂ∞ãÊàøÂêç">
          <span class="icon">
            <iconify-icon icon="ion:search-outline"></iconify-icon>
          </span>
        </div>

        <!-- ÂåØÂÖ•Ë≥áÊñôÊåâÈàïÔºàÊîæÂõûÔºâ -->
        <button class="btn btn-outline-secondary btn-sm ms-2" @click="importRooms">
          <iconify-icon icon="mdi:import" class="me-1"></iconify-icon>
          ÂåØÂÖ•Ë≥áÊñô
        </button>

        <!-- ÂåØÂá∫Ë≥áÊñôÊåâÈàï -->
        <button class="btn btn-outline-secondary btn-sm ms-2" @click="exportRooms">
          <iconify-icon icon="mdi:export" class="me-1"></iconify-icon>
          ÂåØÂá∫Ë≥áÊñô
        </button>
      </div>
      <!-- ...Âè≥ÂÅ¥ÁØ©ÈÅ∏ËàáÊñ∞Â¢ûÊåâÈàï... -->
      <div class="d-flex flex-wrap align-items-center gap-3">
        <select class="form-select form-select-sm w-auto" v-model="selectedStatus">
          <option value="">ÂÖ®ÈÉ®</option>
          <option value="1">‰ª•‰∏äÊû∂</option>
          <option value="0">Êú™‰∏äÊû∂</option>
        </select>
        <button @click="openAddModal" class="btn btn-sm btn-primary-600">
          <i class="ri-add-line"></i> Êñ∞Â¢ûÊàøÂûã
        </button>
      </div>
    </div>

    <!-- Ë°®Ê†ºÂÖßÂÆπ -->
    <div class="card-body">
      <table class="table bordered-table mb-0">
        <thead>
          <tr>
            <th scope="col" @click="sortBy('id')" style="cursor:pointer; user-select:none;">
              Á∑®Ëôü
              <span
                :style="{ color: sortKey === 'id' && sortOrder === 1 ? '#2563eb' : '#bbb', fontSize: '12px' }">‚ñ≤</span>
              <span
                :style="{ color: sortKey === 'id' && sortOrder === -1 ? '#2563eb' : '#bbb', fontSize: '12px', marginLeft: '-2px' }">‚ñº</span>
            </th>
            <th scope="col" style="width:150px;">ÊàøÂêç</th>
            <th scope="col" @click="sortBy('price')" style="cursor:pointer; user-select:none;">
              ÂÉπÊ†º
              <span
                :style="{ color: sortKey === 'price' && sortOrder === 1 ? '#2563eb' : '#bbb', fontSize: '12px' }">‚ñ≤</span>
              <span
                :style="{ color: sortKey === 'price' && sortOrder === -1 ? '#2563eb' : '#bbb', fontSize: '12px', marginLeft: '-2px' }">‚ñº</span>
            </th>
            <th scope="col" @click="sortBy('capacity')" style="cursor:pointer; user-select:none;">
              ‰∫∫Êï∏
              <span
                :style="{ color: sortKey === 'capacity' && sortOrder === 1 ? '#2563eb' : '#bbb', fontSize: '12px' }">‚ñ≤</span>
              <span
                :style="{ color: sortKey === 'capacity' && sortOrder === -1 ? '#2563eb' : '#bbb', fontSize: '12px', marginLeft: '-2px' }">‚ñº</span>
            </th>
            <th scope="col" style="width:150px;">ÂúñÁâáÈ†êË¶Ω</th>
            <th scope="col" @click="sortBy('isAvailable')" style="cursor:pointer; user-select:none; width:120px;">
              Â∑≤‰∏äÊû∂
              <span
                :style="{ color: sortKey === 'isAvailable' && sortOrder === 1 ? '#2563eb' : '#bbb', fontSize: '12px' }">‚ñ≤</span>
              <span
                :style="{ color: sortKey === 'isAvailable' && sortOrder === -1 ? '#2563eb' : '#bbb', fontSize: '12px', marginLeft: '-2px' }">‚ñº</span>
            </th>
            <th scope="col" style="width:180px; text-align:center;">Êìç‰Ωú</th>
          </tr>
        </thead>
        <tbody>
          <tr v-for="(room, index) in filteredInvoices" :key="room.id">
            <!-- Á∑®ËôüÔºàÁßªÈô§ÂãæÈÅ∏Ê°ÜÔºåÂè™È°ØÁ§∫Á∑®ËôüÔºâ -->
            <td>
              {{ room.id }}
            </td>
            <!-- ÊàøÂêç -->
            <td style="width:150px;">
              <h6 class="text-md mb-0 fw-medium flex-grow-1">{{ room.name }}</h6>
            </td>
            <!-- ÂÉπÊ†º -->
            <td>NT$ {{ room.price }}</td>
            <!-- ‰∫∫Êï∏ -->
            <td>
              <span class="px-24 py-4 rounded-pill fw-medium text-sm">
                {{ room.capacity || '-' }} ‰∫∫
              </span>
            </td>
            <!-- ÂúñÁâáÈ†êË¶Ω -->
            <td style="width:150px;">
              <div v-if="room.imagePath" class="image-container">
                <img :src="room.imagePath" :alt="room.name" class="flex-shrink-0 radius-8" width="120" height="90"
                  style="object-fit: cover; cursor: pointer;" @click="openImageModal(room.imagePath)"
                  @error="onImageError(room)" @load="onImageLoad(room)">
              </div>
              <div v-else class="no-image text-center bg-light d-flex align-items-center justify-content-center"
                style="width: 120px; height: 90px; border-radius: 8px;">
                <small class="text-muted">
                  <iconify-icon icon="material-symbols:image" class="me-1"></iconify-icon>
                  ÁÑ°ÂúñÁâá
                </small>
              </div>
            </td>
            <!-- Â∑≤‰∏äÊû∂ÊªëÂãïÈñãÈóú -->
            <td class="text-center" style="width:120px;">
              <div class="form-switch d-flex align-items-center justify-content-center">
                <input class="form-check-input" type="checkbox" role="switch" :id="`switch-${room.id}`"
                  v-model="room.isAvailable" @change="toggleAvailability(room)" style="width: 3rem; height: 1.5rem;">
                <label :for="`switch-${room.id}`" class="form-check-label ms-2 text-sm" style="min-width: 50px;">
                  {{ room.isAvailable ? 'Â∑≤‰∏äÊû∂' : 'Êú™‰∏äÊû∂' }}
                </label>
              </div>
            </td>
            <!-- Êìç‰Ωú -->
            <td class="text-center text-nowrap" style="vertical-align: middle; width:180px;">
              <!-- üëÅÔ∏è È†êË¶ΩÊåâÈàï - Á¢∫‰øùÈªûÊìä‰∫ã‰ª∂Ê≠£Á¢∫ -->
              <button @click.prevent="openPreviewModal(room.id)"
                class="w-32-px h-32-px bg-primary-light text-primary-600 rounded-circle d-inline-flex align-items-center justify-content-center mx-1"
                title="È†êË¶Ω" type="button">
                <iconify-icon icon="iconamoon:eye-light"></iconify-icon>
              </button>

              <button @click="openEditModal(room.id)"
                class="w-32-px h-32-px bg-success-focus text-success-main rounded-circle d-inline-flex align-items-center justify-content-center mx-1"
                title="Á∑®ËºØ">
                <iconify-icon icon="lucide:edit"></iconify-icon>
              </button>

              <!-- Êìç‰ΩúÊ¨Ñ‰ΩçÂÖßÁöÑÂà™Èô§ÊåâÈàï -->
              <button @click="removeRoom(index)"
                class="w-32-px h-32-px bg-danger-focus text-danger-main rounded-circle d-inline-flex align-items-center justify-content-center mx-1"
                title="Âà™Èô§" type="button">
                <iconify-icon icon="mingcute:delete-2-line"></iconify-icon>
              </button>
            </td>
          </tr>
        </tbody>
      </table>

      <!-- ÂàÜÈ†Å -->
      <div class="pagination d-flex gap-2 justify-content-center mt-4">
        <button :disabled="currentPage === 1" @click="goToPage(1)" class="btn btn-light">&laquo;</button>
        <button v-for="page in totalPages" :key="page"
          :class="['btn', currentPage === page ? 'btn-primary' : 'btn-light']" @click="goToPage(page)">
          {{ page }}
        </button>
        <button :disabled="currentPage === totalPages" @click="goToPage(totalPages)"
          class="btn btn-light">&raquo;</button>
      </div>
    </div>
  </div>

  <!-- Add Modal -->
  <div class="modal fade" id="addRoomModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Êñ∞Â¢ûÊàøÂûã</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <RoomAdd @close="closeAddModal" @success="onAddSuccess" />
        </div>
      </div>
    </div>
  </div>

  <!-- Edit Modal -->
  <div class="modal fade" id="editRoomModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Á∑®ËºØÊàøÂûã</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <RoomEdit v-if="selectedRoomId" :roomId="selectedRoomId" @close="closeEditModal" @success="onEditSuccess" />
        </div>
      </div>
    </div>
  </div>

  <!-- Preview Modal -->
  <div class="modal fade" id="previewRoomModal" tabindex="-1" aria-hidden="true" ref="previewModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">ÊàøÂûãÈ†êË¶Ω</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" @click="closePreviewModal"></button>
        </div>
        <div class="modal-body">
          <RoomPreview v-if="showPreviewModal && selectedRoomId" :roomId="selectedRoomId" @close="closePreviewModal" />
        </div>
      </div>
    </div>
  </div>

  <!-- ÂúñÁâáÊîæÂ§ß Modal -->
  <div class="modal fade" id="imagePreviewModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" style="max-width:90vw;">
      <div class="modal-content">
        <div class="modal-header border-0 pb-0">
          <h5 class="modal-title">ÂúñÁâáÈ†êË¶Ω</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body text-center">
          <img :src="previewImageUrl" alt="ÊàøÂûãÂúñÁâá"
            style="max-width:90vw; max-height:80vh; border-radius:12px; box-shadow:0 0 24px #0002;">
        </div>
      </div>
    </div>
  </div>

  <input ref="importFileInput" type="file" accept=".csv" style="display:none" @change="handleImportFile" />
</template>

<script>
// ÈáçÈªûË®ªËß£ÔºöÁµ±‰∏Ä‰ΩøÁî® useToast Ëàá useConfirmDialog ‰ΩúÁÇ∫ÊèêÁ§∫Ê°Ü
import Pagination from '@/components/pagination/index.vue'
import { roomTypeService } from '@/services/roomTypeService';
import RoomAdd from './RoomAdd.vue';
import RoomEdit from './RoomEdit.vue';
import RoomPreview from './RoomPreview.vue';
import { useToast } from '@/composables/useToast';
import { useConfirmDialog } from '@/composables/useConfirmDialog';

export default {
  name: 'RoomList',
  components: {
    Pagination,
    RoomAdd,
    RoomEdit,
    RoomPreview
  },
  data() {
    return {
      selectedShow: 10,
      searchText: '',
      selectedStatus: '',
      selectAll: false,
      selectedIds: [],
      currentPage: 1,
      rooms: [],
      loading: false,
      error: '',
      sortKey: '',
      sortOrder: 1,
      selectedRoomId: null,
      showPreviewModal: false,
      roomTypes: [],
      searchFromDate: '',
      searchToDate: '',
      toastApi: useToast(),           // Toast ÂØ¶‰æã
      confirmApi: useConfirmDialog(),  // ConfirmDialog ÂØ¶‰æã
      previewImageUrl: '', // ÊàøÂûãÂúñÁâáÊîæÂ§ßÈ†êË¶ΩÁî®
    };
  },
  async mounted() {
    this.loading = true;
    try {
      this.rooms = await roomTypeService.getAllRoomTypes();
    } catch (e) {
      this.error = e.message;
      this.toastApi.showToast({
        title: 'ËºâÂÖ•Â§±Êïó',
        message: e.message || 'ËºâÂÖ•ÊàøÂûãË≥áÊñôÂ§±Êïó',
        type: 'error'
      });
    }
    this.loading = false;
  },
  computed: {
    entriesPerPage() {
      return Number(this.selectedShow);
    },
    filteredData() {
      let result = this.rooms;
      if (this.searchText) {
        const search = this.searchText.toLowerCase();
        result = result.filter(room => {
          const name = room.name ? room.name.toLowerCase() : '';
          const desc = room.description ? room.description.toLowerCase() : '';
          if (search === 'ÂñÆ') {
            return (
              (name.includes('ÂñÆ') && !name.includes('Èõô')) ||
              (desc.includes('ÂñÆ') && !desc.includes('Èõô'))
            );
          }
          return name.includes(search) || desc.includes(search);
        });
      }
      if (this.selectedStatus !== '') {
        result = result.filter(room => String(room.isAvailable ? 1 : 0) === this.selectedStatus);
      }
      if (this.sortKey) {
        result = result.slice().sort((a, b) => {
          let valA, valB;
          if (this.sortKey === 'isAvailable') {
            valA = a.isAvailable ? 1 : 0;
            valB = b.isAvailable ? 1 : 0;
          } else {
            valA = Number(a[this.sortKey]);
            valB = Number(b[this.sortKey]);
            if (isNaN(valA) || isNaN(valB)) return 0;
          }
          return (valA - valB) * this.sortOrder;
        });
      }
      return result;
    },
    totalEntries() {
      return this.filteredData.length;
    },
    totalPages() {
      return Math.ceil(this.totalEntries / this.entriesPerPage);
    },
    startIndex() {
      return (this.currentPage - 1) * this.entriesPerPage;
    },
    endIndex() {
      return Math.min(this.startIndex + this.entriesPerPage, this.totalEntries);
    },
    filteredInvoices() {
      return this.filteredData.slice(this.startIndex, this.endIndex);
    }
  },
  watch: {
    selectedShow() { this.currentPage = 1; },
    searchText() { this.currentPage = 1; },
    selectedStatus() { this.currentPage = 1; }
  },
  methods: {
    toggleSelectAll() {
      if (this.selectAll) {
        this.selectedIds = this.filteredInvoices.map(inv => inv.id);
      } else {
        this.selectedIds = [];
      }
    },
    goToPage(page) {
      if (page >= 1 && page <= this.totalPages) {
        this.currentPage = page;
      }
    },
    changePage(page) {
      this.goToPage(page);
    },
    sortBy(key) {
      if (this.sortKey === key) {
        this.sortOrder = -this.sortOrder;
      } else {
        this.sortKey = key;
        this.sortOrder = 1;
      }
    },
    // Âà™Èô§ÊàøÂûãÔºöÁî® useConfirmDialog ‰∫åÊ¨°Á¢∫Ë™çÔºåÁµêÊûúÁî® useToast È°ØÁ§∫
    async deleteRoom(id, index) {
      const confirmed = await this.confirmApi.showConfirmDialog({
        title: 'Âà™Èô§ÊàøÂûã',
        message: 'Á¢∫ÂÆöË¶ÅÂà™Èô§ÈÄôÁ≠ÜÊàøÂûãÂóéÔºü',
        type: 'warning',
        confirmText: 'Á¢∫ÂÆöÂà™Èô§',
        cancelText: 'ÂèñÊ∂à'
      }).catch(() => false);
      if (!confirmed) return;
      try {
        const success = await roomTypeService.deleteRoomType(id);
        if (success) {
          this.rooms.splice(this.startIndex + index, 1);
          this.toastApi.showToast({
            title: 'Âà™Èô§ÊàêÂäü',
            message: 'ÊàøÂûãÂ∑≤ÊàêÂäüÂà™Èô§ÔºÅ',
            type: 'success'
          });
        } else {
          this.toastApi.showToast({
            title: 'Âà™Èô§Â§±Êïó',
            message: 'ÊàøÂûãÂà™Èô§Â§±ÊïóÔºÅ',
            type: 'error'
          });
        }
      } catch (e) {
        this.toastApi.showToast({
          title: 'Âà™Èô§Â§±Êïó',
          message: e.message || 'ÊàøÂûãÂà™Èô§Â§±ÊïóÔºÅ',
          type: 'error'
        });
      }
    },
    // ÁßªÈô§ÊàøÂûãÔºàÂè™ÁßªÈô§Áï´Èù¢Ôºå‰∏çÂà™Ë≥áÊñôÂ∫´ÔºâÔºöÁî® useConfirmDialog
    async removeRoom(index) {
      const confirmed = await this.confirmApi.showConfirmDialog({
        title: 'ÁßªÈô§Ë≥áÊñô',
        message: 'Á¢∫ÂÆöË¶ÅÂæûÁï´Èù¢ÁßªÈô§ÈÄôÁ≠ÜË≥áÊñôÂóéÔºüÔºà‰∏çÊúÉÂà™Èô§Ë≥áÊñôÂ∫´Ôºâ',
        type: 'warning',
        confirmText: 'Á¢∫ÂÆöÁßªÈô§',
        cancelText: 'ÂèñÊ∂à'
      }).catch(() => false);
      if (!confirmed) return;
      this.rooms.splice(this.startIndex + index, 1);
      this.toastApi.showToast({
        title: 'ÁßªÈô§ÊàêÂäü',
        message: 'Ë≥áÊñôÂ∑≤ÂæûÁï´Èù¢ÁßªÈô§',
        type: 'success'
      });
    },
    // Modal Áõ∏ÈóúÊñπÊ≥ï
    openAddModal() {
      const modalElement = document.getElementById('addRoomModal');
      if (modalElement) {
        const modal = new bootstrap.Modal(modalElement);
        modal.show();
      }
    },
    closeAddModal() {
      const modalElement = document.getElementById('addRoomModal');
      if (modalElement) {
        const modal = bootstrap.Modal.getInstance(modalElement);
        if (modal) modal.hide();
      }
    },
    openEditModal(roomId) {
      this.selectedRoomId = roomId;
      this.$nextTick(() => {
        const modalElement = document.getElementById('editRoomModal');
        if (modalElement) {
          const modal = new bootstrap.Modal(modalElement);
          modal.show();
        }
      });
    },
    closeEditModal() {
      const modalElement = document.getElementById('editRoomModal');
      if (modalElement) {
        const modal = bootstrap.Modal.getInstance(modalElement);
        if (modal) modal.hide();
      }
      this.selectedRoomId = null;
    },
    openPreviewModal(roomId) {
      this.selectedRoomId = roomId;
      this.$nextTick(() => {
        const modalElement = document.getElementById('previewRoomModal');
        if (modalElement) {
          const modal = new bootstrap.Modal(modalElement);
          modal.show();
        }
        this.showPreviewModal = true;
      });
    },
    closePreviewModal() {
      const modalElement = document.getElementById('previewRoomModal');
      if (modalElement) {
        const modal = bootstrap.Modal.getInstance(modalElement);
        if (modal) modal.hide();
      }
      this.showPreviewModal = false;
      this.selectedRoomId = null;
    },
    handleEditFromPreview(roomId) {
      this.closePreviewModal();
      this.openEditModal(roomId);
    },
    // Êñ∞Â¢ûÊàêÂäüÂõûË™øÔºöÁî® useToast
    async onAddSuccess() {
      this.closeAddModal();
      await this.refreshData();
      this.toastApi.showToast({
        title: 'Êñ∞Â¢ûÊàêÂäü',
        message: 'ÊàøÂûãÂ∑≤ÊàêÂäüÊñ∞Â¢ûÔºÅ',
        type: 'success'
      });
    },
    // Á∑®ËºØÊàêÂäüÂõûË™øÔºöÁî® useToast
    async onEditSuccess() {
      this.closeEditModal();
      await this.refreshData();
      this.toastApi.showToast({
        title: '‰øÆÊîπÊàêÂäü',
        message: 'ÊàøÂûãÂ∑≤ÊàêÂäü‰øÆÊîπÔºÅ',
        type: 'success'
      });
    },
    async refreshData() {
      this.loading = true;
      try {
        this.rooms = await roomTypeService.getAllRoomTypes();
      } catch (e) {
        this.error = e.message;
        this.toastApi.showToast({
          title: 'ËºâÂÖ•Â§±Êïó',
          message: e.message || 'ËºâÂÖ•ÊàøÂûãË≥áÊñôÂ§±Êïó',
          type: 'error'
        });
      }
      this.loading = false;
    },
    // ÂúñÁâáËºâÂÖ•ÊàêÂäü/Â§±ÊïóËôïÁêÜ
    onImageLoad(room) {
      // ÂèØÂä†Èô§ÈåØË®äÊÅØ
    },
    onImageError(room) {
      // ÂèØÂä†Èô§ÈåØË®äÊÅØ
    },
    // ÂàáÊèõ‰∏äÊû∂ÁãÄÊÖãÔºöÁî® useToast È°ØÁ§∫ÁµêÊûú
    async toggleAvailability(room) {
      const newStatus = room.isAvailable;
      const action = newStatus ? '‰∏äÊû∂Âà∞ÂâçÂè∞' : 'ÂæûÂâçÂè∞‰∏ãÊû∂';
      try {
        const success = await roomTypeService.updateAvailabilityStatus(room.id, newStatus);
        if (success) {
          room.isAvailable = newStatus;

        } else {
          throw new Error('Êõ¥Êñ∞Â§±Êïó');
        }
      } catch (e) {
        this.toastApi.showToast({
          title: 'ÁãÄÊÖãÊõ¥Êñ∞Â§±Êïó',
          message: `${action}Â§±ÊïóÔºö${e.message || e}`,
          type: 'error'
        });
      }
    },
    // ÂåØÂÖ•Ë≥áÊñôÔºöÁî® useToast È°ØÁ§∫ÁµêÊûú
    importRooms() {
      this.$refs.importFileInput.click();
    },
    async handleImportFile(event) {
      const file = event.target.files[0];
      if (!file) return;
      try {
        const res = await roomTypeService.importCSV(file);
        this.toastApi.showToast({
          title: 'ÂåØÂÖ•ÊàêÂäü',
          message: res || 'ÂåØÂÖ•ÊàêÂäüÔºÅ',
          type: 'success'
        });
        await this.refreshData();
      } catch (e) {
        this.toastApi.showToast({
          title: 'ÂåØÂÖ•Â§±Êïó',
          message: e.message || 'ÂåØÂÖ•Â§±ÊïóÔºÅ',
          type: 'error'
        });
      }
      event.target.value = '';
    },
    exportRooms() {
      const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(this.rooms, null, 2));
      const dlAnchorElem = document.createElement('a');
      dlAnchorElem.setAttribute("href", dataStr);
      dlAnchorElem.setAttribute("download", "rooms.json");
      dlAnchorElem.click();
    },
    // ‰æùÊó•ÊúüÁØÑÂúçÊêúÂ∞ãÔºöÁî® useToast È°ØÁ§∫ÈåØË™§
    async searchByDateRange() {
      if (!this.searchFromDate || !this.searchToDate) {
        this.toastApi.showToast({
          title: 'ÊêúÂ∞ãÂ§±Êïó',
          message: 'Ë´ãÈÅ∏ÊìáËµ∑ÂßãËàáÁµêÊùüÊó•Êúü',
          type: 'error'
        });
        return;
      }
      try {
        this.rooms = await roomTypeService.getRoomsByDateRange(this.searchFromDate, this.searchToDate);
        this.currentPage = 1;
      } catch (e) {
        this.toastApi.showToast({
          title: 'ÊêúÂ∞ãÂ§±Êïó',
          message: e.message || 'ÊêúÂ∞ãÂ§±Êïó',
          type: 'error'
        });
      }
    },
    openImageModal(url) {
      this.previewImageUrl = url;
      const modalElement = document.getElementById('imagePreviewModal');
      if (modalElement) {
        const modal = new bootstrap.Modal(modalElement);
        modal.show();
      }
    },
  }
};
</script>

<style scoped>
/* ‰Ω†ÁöÑÊ®£Âºè */
</style>
